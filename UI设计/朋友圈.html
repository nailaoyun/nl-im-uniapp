<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>æœ‹å‹åœˆ - æç®€ç‰ˆ</title>

    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>

    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    fontFamily: { sans: ['-apple-system', 'BlinkMacSystemFont', 'sans-serif'] },
                    colors: {
                        warm: {
                            950: '#0c0a09', 900: '#1c1917', 800: '#292524',
                            700: '#44403c', 600: '#57534e', 500: '#78716c',
                            200: '#e7e5e4', 100: '#f5f5f4',
                        },
                        // æœ‹å‹åœˆä¸“ç”¨è‰²
                        link: { light: '#576b95', dark: '#7e95c5' },
                        bgDetail: { light: '#f7f7f7', dark: '#292524' } // è¯„è®ºåŒºèƒŒæ™¯
                    }
                }
            }
        }
    </script>

    <style>
        .custom-scrollbar::-webkit-scrollbar { display: none; }
        .custom-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
        .smooth-transition { transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); }

        /* å›¾ç‰‡ä¹å®«æ ¼å¸ƒå±€ */
        .grid-1 { grid-template-columns: 1fr; }
        .grid-2, .grid-4 { grid-template-columns: repeat(2, 1fr); width: 66%; }
        .grid-3, .grid-5, .grid-6, .grid-7, .grid-8, .grid-9 { grid-template-columns: repeat(3, 1fr); }

        /* è¯„è®ºåŒºå°ä¸‰è§’ */
        .triangle-up {
            width: 0; height: 0;
            border-left: 6px solid transparent;
            border-right: 6px solid transparent;
            border-bottom: 6px solid #f7f7f7; /* Light mode color */
            position: absolute; top: -5px; left: 10px;
        }
        .dark .triangle-up { border-bottom-color: #292524; } /* Dark mode color */

        /* æ“ä½œèœå•åŠ¨ç”» */
        .action-menu-enter { opacity: 0; transform: translateX(10px) scale(0.95); pointer-events: none; }
        .action-menu-active { opacity: 1; transform: translateX(0) scale(1); pointer-events: auto; }
    </style>
</head>
<body class="bg-gray-100 flex items-center justify-center min-h-screen font-sans p-4 transition-colors duration-500 overflow-hidden relative" id="body-bg">

<!-- ä¸»é¢˜åˆ‡æ¢ -->
<div class="absolute right-6 top-6 md:right-20 md:top-auto flex flex-col gap-2 z-50">
    <button onclick="toggleTheme()" class="w-12 h-12 bg-white dark:bg-warm-800 rounded-full shadow-lg flex items-center justify-center text-gray-600 dark:text-orange-300 hover:scale-110 active:scale-95 transition-all border border-gray-100 dark:border-warm-700 ring-1 ring-black/5 dark:ring-white/10">
        <i data-lucide="sun" class="block dark:hidden w-5 h-5 text-orange-400"></i>
        <i data-lucide="moon" class="hidden dark:block w-5 h-5 text-orange-200"></i>
    </button>
</div>

<!-- æ‰‹æœºå®¹å™¨ -->
<div id="phone-container" class="relative w-full max-w-[375px] h-[812px] rounded-[40px] shadow-2xl overflow-hidden border-[8px] box-content ring-1 flex flex-col smooth-transition bg-white border-white ring-black/5">

    <!-- ================= æ²‰æµ¸å¼å¯¼èˆªæ  (Header) ================= -->
    <div id="nav-header" class="absolute top-0 left-0 w-full z-20 px-5 pt-12 pb-3 flex items-center justify-between transition-colors duration-300">
        <!-- èƒŒæ™¯å±‚ (é€šè¿‡JSæ§åˆ¶é€æ˜åº¦) -->
        <div id="nav-bg" class="absolute inset-0 bg-white dark:bg-warm-900 opacity-0 border-b border-gray-100 dark:border-warm-800 transition-opacity duration-300"></div>

        <!-- å†…å®¹å±‚ -->
        <div class="relative z-10 flex items-center gap-1 cursor-pointer group" onclick="alert('è¿”å›')">
            <i data-lucide="chevron-left" id="nav-icon-left" class="w-7 h-7 text-white transition-colors duration-300"></i>
        </div>

        <div class="relative z-10">
            <span id="nav-title" class="text-[17px] font-bold text-gray-900 dark:text-warm-100 opacity-0 transition-opacity duration-300">æœ‹å‹åœˆ</span>
        </div>

        <div class="relative z-10 cursor-pointer" onclick="alert('è·³è½¬é€šçŸ¥')">
            <i data-lucide="bell" id="nav-icon-right" class="w-6 h-6 text-white transition-colors duration-300"></i>
        </div>
    </div>

    <!-- ================= æ»šåŠ¨å†…å®¹åŒºåŸŸ ================= -->
    <div id="scroll-view" class="flex-1 overflow-y-auto custom-scrollbar bg-white dark:bg-warm-900 relative z-0">

        <!-- 1. å°é¢å›¾åŒºåŸŸ -->
        <div class="relative h-[340px] mb-8 group cursor-pointer">
            <!-- å°é¢å›¾ -->
            <img src="https://images.unsplash.com/photo-1470252649378-9c29740c9fa8?w=800&q=80" class="w-full h-full object-cover">
            <!-- åº•éƒ¨é˜´å½±é®ç½© -->
            <div class="absolute bottom-0 left-0 w-full h-24 bg-gradient-to-t from-black/40 to-transparent"></div>

            <!-- ç”¨æˆ·ä¿¡æ¯ (æ‚¬æŒ‚åœ¨å³ä¸‹è§’) -->
            <div class="absolute bottom-[-30px] right-4 flex items-end gap-3">
                <span class="text-white font-bold text-lg mb-4 drop-shadow-md text-shadow">Kimi</span>
                <div class="w-20 h-20 rounded-xl overflow-hidden border-[3px] border-white dark:border-warm-800 shadow-md bg-gray-200">
                    <img src="https://images.unsplash.com/photo-1535713875002-d1d0cf377fde?w=150" class="w-full h-full object-cover">
                </div>
            </div>
        </div>

        <!-- 2. åŠ¨æ€åˆ—è¡¨ -->
        <div id="feed-list" class="px-4 pb-24 space-y-8">
            <!-- åŠ¨æ€å†…å®¹ç”± JS ç”Ÿæˆ -->
        </div>

    </div>

    <!-- ================= æ‚¬æµ®å‘å¸ƒæŒ‰é’® (FAB) ================= -->
    <button onclick="alert('å‘å¸ƒåŠ¨æ€')" class="absolute bottom-[110px] right-5 w-14 h-14 bg-green-500 hover:bg-green-600 rounded-full shadow-xl shadow-green-500/30 flex items-center justify-center text-white active:scale-90 transition-transform z-30">
        <i data-lucide="camera" class="w-7 h-7"></i>
    </button>

    <!-- ================= åº•éƒ¨ Tab Bar ================= -->
    <div class="absolute bottom-0 w-full h-[84px] bg-white dark:bg-warm-900 border-t border-gray-100 dark:border-warm-800 flex items-center justify-around pb-6 smooth-transition z-20">
        <div onclick="alert('è·³è½¬æ¶ˆæ¯')" class="flex flex-col items-center gap-1 text-gray-400 dark:text-warm-500 hover:text-gray-900 dark:hover:text-warm-200 cursor-pointer transition-colors">
            <i data-lucide="message-circle" class="w-6 h-6"></i>
            <span class="text-[10px] font-medium">æ¶ˆæ¯</span>
        </div>
        <div onclick="alert('è·³è½¬è”ç³»äºº')" class="flex flex-col items-center gap-1 text-gray-400 dark:text-warm-500 hover:text-gray-900 dark:hover:text-warm-200 cursor-pointer transition-colors">
            <i data-lucide="users" class="w-6 h-6"></i>
            <span class="text-[10px] font-medium">è”ç³»äºº</span>
        </div>
        <div class="flex flex-col items-center gap-1 text-indigo-600 dark:text-orange-500 cursor-pointer">
            <i data-lucide="compass" class="w-6 h-6 fill-current"></i>
            <span class="text-[10px] font-bold">å‘ç°</span>
        </div>
        <div class="flex flex-col items-center gap-1 text-gray-400 dark:text-warm-500 hover:text-gray-900 dark:hover:text-warm-200 cursor-pointer transition-colors">
            <i data-lucide="user" class="w-6 h-6"></i>
            <span class="text-[10px] font-medium">æˆ‘çš„</span>
        </div>
    </div>

</div>

<!-- é€»è¾‘è„šæœ¬ -->
<script>
    // --- æ¨¡æ‹Ÿæ•°æ® ---
    const moments = [
        {
            id: 1,
            user: { name: 'æ—å¸Œ', avatar: 'https://images.unsplash.com/photo-1494790108377-be9c29b29330?w=150' },
            content: 'å‘¨æœ«çš„é˜³å…‰çœŸå¥½ï¼Œå»çˆ¬å±±äº†ï¼ğŸ”ï¸ å¤©æ°”æ™´æœ—ï¼Œå¿ƒæƒ…èˆ’ç•…ã€‚',
            images: [
                'https://images.unsplash.com/photo-1551632811-561732d1e306?w=400',
                'https://images.unsplash.com/photo-1464822759023-fed622ff2c3b?w=400',
                'https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=400',
                'https://images.unsplash.com/photo-1486870591958-9b9d0d1dda99?w=400'
            ],
            time: '20åˆ†é’Ÿå‰',
            likes: ['å¼ ä¸‰', 'æå››', 'ç‹äº”'],
            comments: [
                { user: 'å¼ ä¸‰', content: 'æ™¯è‰²çœŸä¸é”™å•Šï¼' },
                { user: 'æå››', content: 'ä¸‹æ¬¡å¸¦æˆ‘ä¸€ä¸ª' }
            ]
        },
        {
            id: 2,
            user: { name: 'ç‹ç»ç†', avatar: 'https://images.unsplash.com/photo-1560250097-0b93528c311a?w=150' },
            content: 'é¡¹ç›®ç»ˆäºä¸Šçº¿äº†ï¼Œå¤§å®¶è¾›è‹¦äº†ï¼ä»Šæ™šèšé¤èµ°èµ· ğŸ»',
            images: ['https://images.unsplash.com/photo-1556761175-5973dc0f32e7?w=400'],
            time: '1å°æ—¶å‰',
            likes: ['Kimi', 'å°èµµ', 'è€é™ˆ', 'æ—å¸Œ'],
            comments: []
        },
        {
            id: 3,
            user: { name: 'é™ˆæ™¨', avatar: 'https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=150' },
            content: 'åˆ†äº«ä¸€é¦–å¥½å¬çš„æ­Œ ğŸµ',
            type: 'music', // æ¨¡æ‹Ÿéå›¾ç‰‡å†…å®¹
            time: '2å°æ—¶å‰',
            likes: [],
            comments: []
        },
        {
            id: 4,
            user: { name: 'éŸ¦é›', avatar: 'https://images.unsplash.com/photo-1438761681033-6461ffad8d80?w=150' },
            content: '', // çº¯å›¾ç‰‡
            images: [
                'https://images.unsplash.com/photo-1490645935967-10de6ba17061?w=400',
                'https://images.unsplash.com/photo-1565299624946-b28f40a0ae38?w=400',
                'https://images.unsplash.com/photo-1482049016688-2d3e1b311543?w=400'
            ],
            time: 'æ˜¨å¤©',
            likes: ['Kimi'],
            comments: [
                { user: 'Kimi', content: 'çœ‹ç€å°±å¥½åƒ ğŸ˜‹' }
            ]
        }
    ];

    let isDarkMode = false;
    let activeMenuId = null; // å½“å‰æ‰“å¼€çš„æ“ä½œèœå•ID

    const els = {
        body: document.getElementById('body-bg'),
        phone: document.getElementById('phone-container'),
        scrollView: document.getElementById('scroll-view'),
        navHeader: document.getElementById('nav-header'),
        navBg: document.getElementById('nav-bg'),
        navTitle: document.getElementById('nav-title'),
        navIconLeft: document.getElementById('nav-icon-left'),
        navIconRight: document.getElementById('nav-icon-right'),
        feedList: document.getElementById('feed-list'),
    };

    window.onload = () => {
        renderFeed();
        lucide.createIcons();

        // æ»šåŠ¨ç›‘å¬
        els.scrollView.addEventListener('scroll', handleScroll);

        // ç‚¹å‡»å¤–éƒ¨å…³é—­èœå•
        document.addEventListener('click', (e) => {
            if (!e.target.closest('.action-area')) {
                closeAllMenus();
            }
        });
    };

    // --- æ»šåŠ¨æ•ˆæœï¼šæ²‰æµ¸å¼å¯¼èˆªæ  ---
    function handleScroll() {
        const scrollTop = els.scrollView.scrollTop;
        const threshold = 200; // æ»šåŠ¨å¤šå°‘åƒç´ åå˜è‰²
        let opacity = Math.min(scrollTop / threshold, 1);

        // 1. èƒŒæ™¯é€æ˜åº¦
        els.navBg.style.opacity = opacity;

        // 2. æ ‡é¢˜é€æ˜åº¦
        els.navTitle.style.opacity = opacity;

        // 3. å›¾æ ‡é¢œè‰²ç¿»è½¬ (ç™½è‰² -> é»‘è‰²/æš–ç™½)
        if (opacity > 0.6) {
            // å˜å®è‰²èƒŒæ™¯æ¨¡å¼
            const iconColor = isDarkMode ? 'text-warm-100' : 'text-gray-900';
            els.navIconLeft.setAttribute('class', `w-7 h-7 transition-colors duration-300 ${iconColor}`);
            els.navIconRight.setAttribute('class', `w-6 h-6 transition-colors duration-300 ${iconColor}`);
        } else {
            // é€æ˜èƒŒæ™¯æ¨¡å¼ (ç™½è‰²å›¾æ ‡)
            els.navIconLeft.setAttribute('class', `w-7 h-7 text-white transition-colors duration-300`);
            els.navIconRight.setAttribute('class', `w-6 h-6 text-white transition-colors duration-300`);
        }
    }

    // --- æ¸²æŸ“åˆ—è¡¨ ---
    function renderFeed() {
        els.feedList.innerHTML = moments.map(item => {
            // å›¾ç‰‡ç½‘æ ¼ç±»å
            let gridClass = '';
            let imgSize = 'w-full h-full'; // é»˜è®¤å¡«æ»¡å®¹å™¨
            let containerSize = 'h-auto';

            if (item.images && item.images.length > 0) {
                const count = item.images.length;
                if (count === 1) {
                    gridClass = 'grid-1';
                    containerSize = 'max-w-[70%]'; // å•å›¾ä¸å æ»¡
                } else if (count === 4) {
                    gridClass = 'grid-2'; // 4å¼ å›¾æ˜¾ç¤ºä¸º2x2
                } else {
                    gridClass = `grid-3`; // å…¶ä»–æƒ…å†µ3åˆ—
                }
            }

            // æ¸²æŸ“å›¾ç‰‡ HTML
            const imagesHtml = item.images ? `
                    <div class="grid gap-1.5 mt-2 ${gridClass} ${item.images.length === 1 ? 'max-w-[200px]' : ''}">
                        ${item.images.map(url => `
                            <div class="aspect-square bg-gray-100 dark:bg-warm-800 rounded-lg overflow-hidden cursor-pointer">
                                <img src="${url}" class="w-full h-full object-cover hover:opacity-90 transition-opacity">
                            </div>
                        `).join('')}
                    </div>
                ` : '';

            // æ¸²æŸ“ç‚¹èµè¯„è®ºåŒº HTML
            const hasInteraction = (item.likes && item.likes.length > 0) || (item.comments && item.comments.length > 0);
            const interactionHtml = hasInteraction ? `
                    <div class="mt-3 bg-gray-100 dark:bg-warm-800/60 rounded-[4px] p-3 relative text-[13px] leading-5">
                        <div class="triangle-up"></div>

                        ${item.likes.length ? `
                        <div class="flex items-start gap-2 mb-1 text-indigo-600 dark:text-blue-400 font-medium">
                            <i data-lucide="heart" class="w-3.5 h-3.5 mt-1 fill-current stroke-none"></i>
                            <span>${item.likes.join('ï¼Œ')}</span>
                        </div>
                        ` : ''}

                        ${item.likes.length && item.comments.length ? `<div class="h-[1px] bg-black/5 dark:bg-white/5 my-1"></div>` : ''}

                        ${item.comments.length ? `
                        <div class="space-y-1">
                            ${item.comments.map(c => `
                                <div>
                                    <span class="text-indigo-600 dark:text-blue-400 font-medium cursor-pointer">${c.user}</span>
                                    <span class="text-gray-800 dark:text-warm-200">ï¼š${c.content}</span>
                                </div>
                            `).join('')}
                        </div>
                        ` : ''}
                    </div>
                ` : '';

            return `
                <div class="flex gap-3 border-b border-gray-100 dark:border-warm-800/50 pb-6 last:border-0">
                    <!-- å¤´åƒ -->
                    <div class="shrink-0">
                        <img src="${item.user.avatar}" class="w-[42px] h-[42px] rounded-lg bg-gray-200 object-cover cursor-pointer">
                    </div>

                    <!-- å†…å®¹ -->
                    <div class="flex-1 min-w-0 pt-1">
                        <div class="font-bold text-[15px] text-indigo-600 dark:text-blue-400 mb-1 cursor-pointer">${item.user.name}</div>
                        ${item.content ? `<div class="text-[15px] text-gray-900 dark:text-warm-100 leading-normal mb-1">${item.content}</div>` : ''}

                        ${imagesHtml}

                        <!-- åº•éƒ¨æ  -->
                        <div class="flex items-center justify-between mt-3 h-6 relative action-area">
                            <span class="text-xs text-gray-400 dark:text-warm-500">${item.time}</span>

                            <!-- ä¸¤ä¸ªç‚¹æŒ‰é’® -->
                            <div onclick="toggleActionMenu(${item.id})" class="w-8 h-5 bg-gray-100 dark:bg-warm-800/80 rounded-[4px] flex items-center justify-center cursor-pointer hover:bg-gray-200 dark:hover:bg-warm-700 transition-colors">
                                <div class="flex gap-[3px]">
                                    <div class="w-1 h-1 bg-indigo-600 dark:bg-blue-400 rounded-full"></div>
                                    <div class="w-1 h-1 bg-indigo-600 dark:bg-blue-400 rounded-full"></div>
                                </div>
                            </div>

                            <!-- å¼¹å‡ºèœå• -->
                            <div id="menu-${item.id}" class="absolute right-10 top-[-6px] bg-gray-800 dark:bg-warm-700 text-white rounded-[4px] flex items-center overflow-hidden shadow-lg transition-all duration-200 action-menu-enter">
                                <div class="flex items-center gap-1 px-4 py-2.5 cursor-pointer hover:bg-white/10 active:bg-white/20 transition-colors border-r border-white/10">
                                    <i data-lucide="heart" class="w-4 h-4"></i>
                                    <span class="text-xs font-medium">èµ</span>
                                </div>
                                <div class="flex items-center gap-1 px-4 py-2.5 cursor-pointer hover:bg-white/10 active:bg-white/20 transition-colors">
                                    <i data-lucide="message-square" class="w-4 h-4"></i>
                                    <span class="text-xs font-medium">è¯„è®º</span>
                                </div>
                            </div>
                        </div>

                        ${interactionHtml}
                    </div>
                </div>
                `;
        }).join('');
    }

    // --- äº¤äº’é€»è¾‘ ---
    function toggleActionMenu(id) {
        const menu = document.getElementById(`menu-${id}`);
        const isActive = menu.classList.contains('action-menu-active');

        // å…ˆå…³é—­æ‰€æœ‰
        closeAllMenus();

        if (!isActive) {
            menu.classList.remove('action-menu-enter');
            menu.classList.add('action-menu-active');
            activeMenuId = id;
        }
        lucide.createIcons(); // åˆ·æ–°å›¾æ ‡ï¼ˆå¦‚æœèœå•æ˜¯åŠ¨æ€ç”Ÿæˆçš„ï¼‰
    }

    function closeAllMenus() {
        document.querySelectorAll('[id^="menu-"]').forEach(el => {
            el.classList.remove('action-menu-active');
            el.classList.add('action-menu-enter');
        });
        activeMenuId = null;
    }

    function toggleTheme() {
        isDarkMode = !isDarkMode;
        const html = document.documentElement;
        const body = document.getElementById('body-bg');
        const phone = document.getElementById('phone-container');

        if (isDarkMode) {
            html.classList.add('dark');
            body.className = "bg-[#0c0a09] flex items-center justify-center min-h-screen font-sans p-4 transition-colors duration-500 overflow-hidden relative";
            phone.className = "relative w-full max-w-[375px] h-[812px] rounded-[40px] shadow-2xl overflow-hidden border-[8px] box-content ring-1 flex flex-col smooth-transition bg-warm-900 border-warm-800 ring-white/10 shadow-black/50";
        } else {
            html.classList.remove('dark');
            body.className = "bg-gray-100 flex items-center justify-center min-h-screen font-sans p-4 transition-colors duration-500 overflow-hidden relative";
            phone.className = "relative w-full max-w-[375px] h-[812px] rounded-[40px] shadow-2xl overflow-hidden border-[8px] box-content ring-1 flex flex-col smooth-transition bg-white border-white ring-black/5";
        }
        // è§¦å‘ä¸€æ¬¡æ»šåŠ¨ä»¥æ›´æ–° Header å›¾æ ‡é¢œè‰²
        handleScroll();
        setTimeout(() => lucide.createIcons(), 50);
    }
</script>
</body>
</html>
